<!doctype html>

<!--
    Teaching computing concepts through a "gameified" command line. 
    This is an open source project by Joel Peckham and 
    Proffesor Robert Ordóñez of Southern Adventist University.
    October 8, 2019
-->

<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Terminal</title>
  <meta name="description" content="Teaching computing concepts through a gameified command line.">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="styles.css" type = "text/css" >

  <!-- xterm.js must be installed through npm-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.js"></script>

</head>

<body>

  <div id="terminal"></div>
      <script>
        var term = new Terminal();
        term.open(document.getElementById('terminal'));
        function runFakeTerminal() {
        if (term._initialized) {
            return;
        }

        term._initialized = true;

        term.prompt = () => {
            term.write('\r\n$ ');
        };

        term.writeln('Welcome to xterm.js');
        term.writeln('This is a local terminal emulation, without a real terminal in the back-end.');
        term.writeln('Type some keys and commands to play around.');
        term.writeln('');
        prompt(term);

        term.onKey(e => {
            const printable = !e.domEvent.altKey && !e.domEvent.altGraphKey && !e.domEvent.ctrlKey && !e.domEvent.metaKey;

            if (e.domEvent.keyCode === 13) {
                prompt(term);
            } else if (e.domEvent.keyCode === 8) {
                // Do not delete the prompt
                if (term._core.buffer.x > 2) {
                    term.write('\b \b');
                }
            } else if (printable) {
                term.write(e.key);
            }
        });
    }

    function prompt(term) {
      term.write('\r\n$ ');
    }
    runFakeTerminal();
      </script>

</body>

</html>